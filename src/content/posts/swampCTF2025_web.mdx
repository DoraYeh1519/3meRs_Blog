---
title: "SwampCTF2025 Writeup: Part1 Web"
description: "è§£äº†ä¸€äº›ç°¡å–®çš„é¡Œç›®ï¼Œç´€éŒ„ä¸€ä¸‹ç•¶ä½œç·´ç¿’å¯« writeupï¼Œå¾Œé¢æ›´æ–°å¯èƒ½åœ¨é€™è£¡æˆ–å¤šç™¼å¹¾ç¯‡"
image: "../assets/gator.jpg"
createdAt: 04-01-2025
draft: false
tags:
  - swampCTF_2025
  - web
---

## SwampCTF Intro

SwampCTF æ˜¯ UFSIT ï¼ˆ UF Student Infosec Team ï¼‰èˆ‰è¾¦çš„ CTF ï¼Œå…±æœ‰ä¸ƒå€‹é¡åˆ¥ï¼š
* Pwn
* RE
* Web
* Crypto
* Forensics
* Misc
* OSINT

ä»Šå¹´åœ¨ 3/29 åˆ° 3/30 å…©å¤©èˆ‰è¾¦ï¼Œé€™æ¬¡æˆ‘åªæ‰“äº† Web, Forensics, Misc å’Œ OSINT é€™å››å€‹é¡åˆ¥ï¼Œå°±æˆ‘è§£å‡ºä¾†çš„éƒ¨åˆ†ä¾†èªªï¼Œé¡Œç›®ç›¸ç•¶ beginner-friendlyã€‚  

è€Œä¸”å¯èƒ½æ˜¯æˆ‘æ¯”è¼ƒå¼±ã€‚æˆ‘è¦ºå¾— SwampCTF 2025 åœ¨é€™å¹¾å€‹é ˜åŸŸçš„é¡Œç›®ï¼Œçœ‹é‡è¨Šæ¯æ”¶é›†èƒ½åŠ›æ¯”æŠ€è¡“èƒ½åŠ›ä¾†å¾—å¤šä¸€é»ï¼Œç”šè‡³æœ‰ä¸€äº›çŒœæ¸¬çš„æˆåˆ†ã€‚  

é€™æ¬¡ç¸½å…±è§£äº† 14 é¡Œã€‚ç¸½å…± 1348 åˆ†ï¼Œåœ˜éšŠæ’å 135ï¼751ï¼Œä½†å…¶å¯¦ç¬¬ 10 åå¾Œå°±æœ‰å¾ˆå¤šå€‹äººåƒè³½è€…ã€‚

![ranking](/img/swampCTF/rank.png)

ï¼ˆçé …æ˜¯ç”¨äº†æç¤ºæ‰£15åˆ†ï¼Œç¬‘æ­»ï¼‰  
é€™æ˜¯è§£é–‹çš„é¡Œå–®ï¼š

![questions](/img/swampCTF/questionnaire.png)

## Web
é€™æ¬¡è§£äº†æœ€ç°¡å–®çš„å››é¡Œä¸€å…± 200 åˆ†

### Serialies - 20 pts
![question1](/img/swampCTF/web/serialies/srl(1).png)  

é¡Œç›®åªçµ¦äº†ä¸€å€‹ç¶²å€ http://chals.swampctf.com:44444/ å’Œä¸€å€‹æª”æ¡ˆ

ç¶²å€é»é–‹ä¾†é•·é€™æ¨£ï¼ŒF12 çœ‹èµ·ä¾†ä¹Ÿæ²’æ±è¥¿ã€‚é‚„æ˜¯å¾—çœ‹æª”æ¡ˆ

![webisteQ1](/img/swampCTF/web/serialies/website.png)  

æª”æ¡ˆæ˜¯å€‹ zip ï¼Œè§£å£“å¾Œæ˜¯ä¸€å€‹ç”¨ java spring æ¶çš„ api æ¶æ§‹ï¼Œåœ¨ personController.java è£¡é¢æœ‰ä¸€å€‹é¡¯çœ¼çš„åœ°å€ï¼š
```/api/person```  

![fileQ1](/img/swampCTF/web/serialies/srl(2).png) 

ç›´æ¥è©¦ä¸€ä¸‹
```
 http://chals.swampctf.com:44444/api/person
```

![flagQ1](/img/swampCTF/web/serialies/srl(3).png) 

æŒ‰ ctrl+F æœå°‹å¾Œç™¼ç¾æ»¿å±±éé‡çš„ flag

![pokemonMeme](/img/swampCTF/web/serialies/pikachu.jpeg) 

---
<div class="text-center">
  <span>ğŸš©</span>
  <span style="color:#1fdcb6">**swampCTF\{f1l3_r34d_4nd_d3s3r14l1z3_pwn4g3_x7q9z2r5v8\}**</span>
</div>
---

### SlowAPI - 50 pts
![question2](/img/swampCTF/web/slowAPI/API(1).png)  

é¡Œç›®æœ‰å…©å€‹æ¯”è¼ƒé‡è¦çš„è³‡è¨Šï¼Œç¬¬ä¸€å€‹ç¶²å€ http://chals.swampctf.com:43611 ï¼Œç¬¬äºŒæ˜¯ä»–æåˆ°é—œæ–¼ Next.js çš„å–§å›‚ï¼ˆï¼Ÿï¼‰

æˆ‘ç¢ºå¯¦æœ‰å°è±¡å¤§æ¦‚ä¸€é€±å‰è½åˆ°é Next.js æœ‰ä¸€å€‹ CVE ï¼ŒæŸ¥äº†ä¸€ä¸‹çœ‹åˆ°é€™ç¯‡æ–‡ç«  ã€ŠNextJS CVE-2025-29927 å®‰å…¨æ¼æ´ã€‹ï¼ˆ https://www.cnblogs.com/risheng/p/18790592 ï¼‰  

![CVE](/img/swampCTF/web/slowAPI/API(5).png)

è£¡é¢æåˆ°äº†æ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹å¼ï¼š  
åŸºæœ¬ä¸Šå°±æ˜¯åœ¨è«‹æ±‚ä¸­å¢åŠ æˆ–ä¿®æ”¹è«‹æ±‚é ­ x-middleware-subrequest ï¼Œè®“ Next.js ä»¥ç‚ºé€™æ˜¯å…§éƒ¨è«‹æ±‚ï¼Œé€²è€ŒéŒ¯èª¤åœ°å…è¨±è¨ªå•å—ä¿è­·çš„ API æˆ–è³‡æ–™ã€‚  
ex:
```
x-middleware-subrequest: middleware:middleware:middleware
```
é»é–‹é¡Œç›®ç¶²å€ï¼Œæ˜¯ä¸€å€‹ç¶²ç«™ SwampAPIï¼Œè£¡é¢æœ‰ä¸‰å€‹å¯é»æ“Šé é¢ï¼šHome, Login, Secret Flag

Home:
  
![home](/img/swampCTF/web/slowAPI/API(2).png)

Login:

![login](/img/swampCTF/web/slowAPI/API(3).png)

èªªä»–ç™»å…¥å’Œè¨»å†ŠåŠŸèƒ½é‚„ä¸èƒ½ç”¨

Secret Flag:

![flagnone](/img/swampCTF/web/slowAPI/API(4).png)

ç†æ‰€ç•¶ç„¶çš„ Access Deniedï¼Œä½†çœ‹åˆ°äº†æç¤ºï¼š"Maybe there's a way to convince the API that you are a server-side middleware process."ï¼Œç¬¦åˆå‰›å‰›çœ‹åˆ°çš„æ¼æ´åˆ©ç”¨æ–¹å¼ã€‚

åˆ‡åˆ° firefox æ‰“é–‹ devtool --> network ï¼Œ Ctrl + R çœ‹åˆ°ä¸€å€‹ç™¼å‘ backend:8000/api/protected/flag çš„è«‹æ±‚ï¼Œç·¨è¼¯è«‹æ±‚ç…§è‘—å‰é¢èªªæ˜çš„æ–¹å¼ä¿®æ”¹ï¼ŒåŠ ä¸Šï¼š
```
x-middleware-subrequest: middleware:middleware:middleware
```

å‡ºç¾  NS_ERROR_UNKNOWN_HOST çš„éŒ¯èª¤

![flagnone2](/img/swampCTF/web/slowAPI/API(7).png)

æŠŠ Host æ”¹æˆ http://chals.swampctf.com:43611/api/protected/flag ï¼Œä¸€æ¨£çš„ header å†ç™¼ä¸€æ¬¡

![flag](/img/swampCTF/web/slowAPI/API(8).png)    

---
<div class="text-center">
  <span>ğŸš©</span>
  <span style="color:#1fdcb6">**swampCTF\{b3w4r3_th3_m1ddl3w4r3\}**</span>
</div>
--- 

### Hidden Message-Board - 50 pts
![question3](/img/swampCTF/web/HiddenMessage-Board/hmb.png)