---
title: "[Writeup] SwampCTF2025(Part1): Web"
description: "è§£äº†ä¸€äº›ç°¡å–®çš„é¡Œç›®ï¼Œç´€éŒ„ä¸€ä¸‹ç•¶ä½œç·´ç¿’å¯« writeupï¼Œå¾Œé¢æ›´æ–°å¯èƒ½åœ¨é€™è£¡æˆ–å¤šç™¼å¹¾ç¯‡"
image: "../assets/gator.jpg"
createdAt: 04-01-2025
draft: false
tags:
  - swampCTF_2025
  - web
---

## SwampCTF Intro

SwampCTF æ˜¯ UFSIT ï¼ˆ UF Student Infosec Team ï¼‰èˆ‰è¾¦çš„ CTF ï¼Œå…±æœ‰ä¸ƒå€‹é¡åˆ¥ï¼š

- Pwn
- RE
- Web
- Crypto
- Forensics
- Misc
- OSINT

ä»Šå¹´åœ¨ 3/29 åˆ° 3/30 å…©å¤©èˆ‰è¾¦ï¼Œé€™æ¬¡æˆ‘åªæ‰“äº† Web, Forensics, Misc å’Œ OSINT é€™å››å€‹é¡åˆ¥ï¼Œå°±æˆ‘è§£å‡ºä¾†çš„éƒ¨åˆ†ä¾†èªªï¼Œé¡Œç›®ç›¸ç•¶ beginner-friendlyã€‚

è€Œä¸”å¯èƒ½æ˜¯æˆ‘æ¯”è¼ƒå¼±ã€‚æˆ‘è¦ºå¾— SwampCTF 2025 åœ¨é€™å¹¾å€‹é ˜åŸŸçš„é¡Œç›®ï¼Œçœ‹é‡è¨Šæ¯æ”¶é›†èƒ½åŠ›æ¯”æŠ€è¡“èƒ½åŠ›ä¾†å¾—å¤šä¸€é»ï¼Œç”šè‡³æœ‰ä¸€äº›çŒœæ¸¬çš„æˆåˆ†ã€‚

é€™æ¬¡ç¸½å…±è§£äº† 14 é¡Œã€‚ç¸½å…± 1348 åˆ†ï¼Œåœ˜éšŠæ’å 135ï¼751ï¼Œä½†å…¶å¯¦ç¬¬ 10 åå¾Œå°±æœ‰å¾ˆå¤šå€‹äººåƒè³½è€…ã€‚

![ranking](/img/swampCTF/rank.png)

ï¼ˆçé …æ˜¯ç”¨äº†æç¤ºæ‰£ 15 åˆ†ï¼Œç¬‘æ­»ï¼‰  
é€™æ˜¯è§£é–‹çš„é¡Œå–®ï¼š

![questions](/img/swampCTF/questionnaire.png)

## Web

é€™æ¬¡è§£äº†æœ€ç°¡å–®çš„å››é¡Œï¼Œä¸€å…± 220 åˆ†

### Serialies - 20 pts

![question1](</img/swampCTF/web/serialies/srl(1).png>)

é¡Œç›®åªçµ¦äº†ä¸€å€‹ç¶²å€ http://chals.swampctf.com:44444/ å’Œä¸€å€‹æª”æ¡ˆ

ç¶²å€é»é–‹ä¾†é•·é€™æ¨£ï¼ŒF12 çœ‹èµ·ä¾†ä¹Ÿæ²’æ±è¥¿ã€‚é‚„æ˜¯å¾—çœ‹æª”æ¡ˆ

![webisteQ1](/img/swampCTF/web/serialies/website.png)

æª”æ¡ˆæ˜¯å€‹ zip ï¼Œè§£å£“å¾Œæ˜¯ä¸€å€‹ç”¨ java spring æ¶çš„ api æ¶æ§‹ï¼Œåœ¨ personController.java è£¡é¢æœ‰ä¸€å€‹é¡¯çœ¼çš„åœ°å€ï¼š
`/api/person`

![fileQ1](</img/swampCTF/web/serialies/srl(2).png>)

ç›´æ¥è©¦ä¸€ä¸‹

```
 http://chals.swampctf.com:44444/api/person
```

![flagQ1](</img/swampCTF/web/serialies/srl(3).png>)

æŒ‰ ctrl+F æœå°‹å¾Œç™¼ç¾æ»¿å±±éé‡çš„ flag

![pokemonMeme](/img/swampCTF/web/serialies/pikachu.jpeg)

---

<div class="text-center">
  <span>ğŸš©</span>
  <span style="color:#1fdcb6">**swampCTF\{f1l3_r34d_4nd_d3s3r14l1z3_pwn4g3_x7q9z2r5v8\}**</span>
</div>
---

### SlowAPI - 50 pts

![question2](</img/swampCTF/web/slowAPI/API(1).png>)

é¡Œç›®æœ‰å…©å€‹æ¯”è¼ƒé‡è¦çš„è³‡è¨Šï¼Œç¬¬ä¸€å€‹ç¶²å€ http://chals.swampctf.com:43611 ï¼Œç¬¬äºŒæ˜¯ä»–æåˆ°é—œæ–¼ Next.js çš„å–§å›‚ï¼ˆï¼Ÿï¼‰

æˆ‘ç¢ºå¯¦æœ‰å°è±¡å¤§æ¦‚ä¸€é€±å‰è½åˆ°é Next.js æœ‰ä¸€å€‹ CVE ï¼ŒæŸ¥äº†ä¸€ä¸‹çœ‹åˆ°é€™ç¯‡æ–‡ç«  ã€ŠNextJS CVE-2025-29927 å®‰å…¨æ¼æ´ã€‹ï¼ˆ https://www.cnblogs.com/risheng/p/18790592 ï¼‰

![CVE](</img/swampCTF/web/slowAPI/API(5).png>)

è£¡é¢æåˆ°äº†æ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹å¼ï¼š  
åŸºæœ¬ä¸Šå°±æ˜¯åœ¨è«‹æ±‚ä¸­å¢åŠ æˆ–ä¿®æ”¹è«‹æ±‚é ­ x-middleware-subrequest ï¼Œè®“ Next.js ä»¥ç‚ºé€™æ˜¯å…§éƒ¨è«‹æ±‚ï¼Œé€²è€ŒéŒ¯èª¤åœ°å…è¨±è¨ªå•å—ä¿è­·çš„ API æˆ–è³‡æ–™ã€‚  
ex:
```
x-middleware-subrequest: middleware:middleware:middleware
```

é»é–‹é¡Œç›®ç¶²å€ï¼Œæ˜¯ä¸€å€‹ç¶²ç«™ SwampAPIï¼Œè£¡é¢æœ‰ä¸‰å€‹å¯é»æ“Šé é¢ï¼šHome, Login, Secret Flag

Home:

![home](</img/swampCTF/web/slowAPI/API(2).png>)

Login:

![login](</img/swampCTF/web/slowAPI/API(3).png>)

èªªä»–ç™»å…¥å’Œè¨»å†ŠåŠŸèƒ½é‚„ä¸èƒ½ç”¨

Secret Flag:

![flagnone](</img/swampCTF/web/slowAPI/API(4).png>)

ç†æ‰€ç•¶ç„¶çš„ Access Deniedï¼Œä½†çœ‹åˆ°äº†æç¤ºï¼š"Maybe there's a way to convince the API that you are a server-side middleware process."ï¼Œç¬¦åˆå‰›å‰›çœ‹åˆ°çš„æ¼æ´åˆ©ç”¨æ–¹å¼ã€‚

åˆ‡åˆ° firefox æ‰“é–‹ devtool --> network ï¼Œ Ctrl + R çœ‹åˆ°ä¸€å€‹ç™¼å‘ backend:8000/api/protected/flag çš„è«‹æ±‚ï¼Œç·¨è¼¯è«‹æ±‚ç…§è‘—å‰é¢èªªæ˜çš„æ–¹å¼ä¿®æ”¹ï¼ŒåŠ ä¸Šï¼š

```
x-middleware-subrequest: middleware:middleware:middleware
```

![flagnone2](</img/swampCTF/web/slowAPI/API(7).png>)

å‡ºç¾ NS_ERROR_UNKNOWN_HOST çš„éŒ¯èª¤

æŠŠ Host æ”¹æˆ http://chals.swampctf.com:43611/api/protected/flag ï¼Œä¸€æ¨£çš„ header å†ç™¼ä¸€æ¬¡

![flag](</img/swampCTF/web/slowAPI/API(8).png>)

---

<div class="text-center">
  <span>ğŸš©</span>
  <span style="color:#1fdcb6">**swampCTF\{b3w4r3_th3_m1ddl3w4r3\}**</span>
</div>
---

### Hidden Message-Board - 50 pts

![question3](/img/swampCTF/web/HiddenMessage-Board/hmb.png)

çµ¦äº†ä¸€å€‹ç¶²é  http://chals.swampctf.com:43333 ï¼Œé»é–‹ä¾†å°±æ˜¯ä¸€å€‹~~çœ‹èµ·ä¾†éå¸¸åˆå­¸~~çš„ç•™è¨€æ¿  
æ ¹æ“šæç¤ºæ‰“é–‹ devtool ï¼Œç™¼ç¾æœ‰ä¸€å€‹ display:none çš„è¨»é‡‹

```
Need to remove flagstuff, code: G1v3M3Th3Fl@g!!!!
```

å¾ network Ctrl+F æŸ¥è©¢è¨»é‡‹æ‰€èªªçš„ flagstuff ï¼Œåœ¨ bundle.js ä¸­ç™¼ç¾äº†ä¸€äº›å‡½æ•¸ï¼š

```
var printFlagSetup = document.getElementById("flagstuff");
console.log("Flag Will Be Checked");
...
async function checkCode() {
    if (printFlagSetup != undefined) {
      console.log(printFlagSetup.getAttribute("code"));
      if (printFlagSetup.getAttribute("code") === "G1v3M3Th3Fl@g!!!!") {
        const flag = await (0,_Messages_tsx__WEBPACK_IMPORTED_MODULE_3__.getFlag)();
        setFlagValue("[flag]: " + flag);
      }
    }
  }
```

å…ˆåœ¨ console è©¦
`document.getElementById("flagstuff").setAttribute("code", "G1v3M3Th3Fl@g!!!!")`
ï¼Œçµæœä»€éº¼éƒ½æ²’æœ‰

å¾ç•™è¨€æ¿å˜—è©¦ XXS
`<div id="flagstuff" code="G1v3M3Th3Fl@g!!!!"></div>`

![flag](</img/swampCTF/web/HiddenMessage-Board/hmb(3).png>)

Bingo!

---

<div class="text-center">
  <span>ğŸš©</span>
  <span style="color:#1fdcb6">**swampCTF\{Cr0ss_S1t3_Scr1p1ing_0r_XSS_c4n_ch4ng3_w3bs1t3s\}**</span>
</div>
---

### Beginner Web - 100 pts

![question4](/img/swampCTF/web/BeginnerWeb/bw.png)

é€™å€‹é¡Œç›®å°‡ flag åˆ†æˆä¸‰å€‹ partï¼Œä¸¦çµ¦äº†ä¸€å€‹ç¶²å€ http://chals.swampctf.com:42222/

é»é€²å»æ˜¯ä¸€å€‹ç¶²é ï¼Œå”¯ä¸€çš„åŠŸèƒ½ä¼¼ä¹æ˜¯å‘Šè¨´æˆ‘å€‘ä»Šå¤©æ˜¯ä¸æ˜¯æ˜ŸæœŸäºŒï¼ˆhint: æ¯”è³½å…©å¤©æ˜¯å‘¨æœ«ï¼‰

å…ˆæ‰“é–‹ devtool çœ‹çœ‹

![flagpart1](</img/swampCTF/web/BeginnerWeb/bw(2).png>)

ç›´æ¥æ‰¾åˆ° part1 äº†

```
<!--Part 1 of the flag: w3b_"-->
```

ç„¶å¾Œæ…£ä¾‹çš„ä¹Ÿè·‘åˆ° network Ctrl+F æœå°‹ flag

ç™¼ç¾äº† favicon.ico ä¸­çš„è«‹æ±‚é ­ä¸­æœ‰

```
flagPart3: c0mpl1c473d
```

ç¾åœ¨æ‰¾åˆ°é ­å°¾äº†ï¼Œå‰©ä¸‹ part2ã€‚ç›´æ¥åœ¨ network æœå°‹äº† part2ï¼Œç™¼ç¾åœ¨ main-34VY7I6V.js è£¡é¢æœ‰ä¸€æ®µï¼š

```
var gs = class e {
    constructor(t) {
        this.cookieService = t;
        let n = "flagPart2_3"
          , r = "U2FsdGVkX1/oCOrv2BF34XQbx7f34cYJ8aA71tr8cl8="
          , o = "U2FsdGVkX197aFEtB5VUIBcswkWs4GiFPal6425rsTU=";
        this.cookieService.set("flagPart2", $n.AES.decrypt(r, n).toString($n.enc.Utf8), {
            expires: 7,
            path: "/",
            secure: !0,
            sameSite: "Strict"
        });
        let i = new Headers;
        i.set("flagPart3", $n.AES.decrypt(o, n).toString($n.enc.Utf8)),
        fetch("/favicon.ico", {
            headers: i
        })
    }
...
```

é¡¯ç„¶å¾ŒåŠæ®µèªªæ˜äº†æˆ‘å€‘å‰›å‰›åœ¨ favicon.ico æ‰¾åˆ° part3 çš„åŸå› ã€‚

è€Œå‰åŠæ®µå‰‡èªªæ˜äº† part2 æœƒè¢« AES è§£å¯†ä¸¦è¨­æˆ cookie ï¼Œå‰ææ˜¯åœ¨å®‰å…¨ç€è¦½çš„æƒ…æ³ä¸‹ã€‚

é¦¬ä¸Šè©¦è©¦çœ‹å¯ä¸å¯ä»¥ç›´æ¥ `https://chals.swampctf.com:42222/`

![error](</img/swampCTF/web/BeginnerWeb/bw(4).png>)

å¥½å§ï¼Œä¸è¡Œ

åªå¥½~~è®“ copilot~~å¯«ä¸€æ®µ code ä¾† decode äº†

```
const CryptoJS = require("crypto-js");

function decodeFlagPart2() {
  const encryptedText = "U2FsdGVkX1/oCOrv2BF34XQbx7f34cYJ8aA71tr8cl8="; // r çš„å€¼
  const key = "flagPart2_3"; // n çš„å€¼

  // decode
  const decryptedText = CryptoJS.AES.decrypt(encryptedText, key).toString(
    CryptoJS.enc.Utf8
  );

  console.log("Decoded flagPart2:", decryptedText);
}

decodeFlagPart2();
```

Terminal:

```
> node decodeFlagPart2.js
> Decoded flagPart2: br0w53r5_4r3_
```

---

<div class="text-center">
  <span>ğŸš©</span>
  <span style="color:#1fdcb6">**swampCTF\{w3b_br0w53r5_4r3_c0mpl1c473d\}**</span>
</div>
---

## Conclusion

é€™äº›é¡Œç›®éƒ½æŒºç°¡å–®çš„ï¼ˆå› ç‚ºæˆ‘ä¹ŸåªæŒ‘ç°¡å–®çš„è§£ï¼‰ï¼Œä½†æˆ‘ä¹Ÿæœ‰å¾ä¸­å­¸åˆ°æ±è¥¿ï¼Œç”šè‡³é‚„è€ƒé©—äº†å¹³å¸¸æœ‰æ²’æœ‰åœ¨é—œæ³¨è³‡å®‰æ–°èçš„éƒ¨åˆ†ã€‚åªèƒ½èªªå‡ºé¡Œåœ˜éšŠå¤ªç¥å•¦ï¼

ç„¶å¾Œæ˜¯é€™ç¯‡ writeup å¯«å¾—å¥½ç´¯ï¼ŒåŒ…å«å¾å‰æœŸæˆªåœ–ï¼Œåˆ°é–‹å§‹å¯«èŠ±äº†å¾ˆå¤šæ™‚é–“åœ¨å–¬åœ–ç‰‡ï¼Œè€Œä¸”æˆªåœ–å‘ˆç¾çš„éƒ¨åˆ†å’Œæ–‡å­—èªªæ˜ä¹Ÿè¦æœ‰æ‰€å–æ¨ã€‚

å¹³å¸¸æœ‰åœ¨å¯« writeup çš„äººçœŸçš„å¥½å‰å¤§ï¼Œäº†ä¸èµ·äº†ä¸èµ·ã€‚

å¾Œé¢åˆ¥çš„é¡åˆ¥æ‡‰è©²æœƒç”¨åˆ¥ç¯‡æ›´æ–°ï¼Œé€™ç¯‡å°±åˆ°é€™è£¡äº†ã€‚
